<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title><%= exam.examName %> - Terzettoo Report</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    h3 {
      color: #343a40;
      font-weight: bold;
      text-align: center;
      margin-bottom: 25px;
      font-size: 2rem;
    }
    .exam-details-card {
      padding: 30px;
      border-radius: 12px;
      transition: box-shadow 0.3s ease;
      margin-bottom: 30px;
    }
    .header-info {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
    }
    .header-info p {
      font-size: 1rem;
      color: #6c757d;
      line-height: 1.5;
      margin: 5px 0;
    }
    .header-info strong {
      color: #343a40;
    }
    .questions-section {
      width: 80%;
      margin: auto;
    }
    .questions-section h4 {
      color: #495057;
      font-weight: 600;
      margin-bottom: 15px;
      font-size: 1.25rem;
    }
    ul {
      list-style-type: none;
      padding-left: 0;
      margin-bottom: 30px;
    }
    li {
      margin-bottom: 20px;
      padding-bottom: 20px;
      border-bottom: 1px solid #e9ecef;
    }
    li:last-child {
      border-bottom: none;
    }
    .options-list {
      padding-left: 20px;
      margin-top: 10px;
    }
    .options-list li {
      font-size: 1rem;
      margin-bottom: 8px;
      padding-left: 10px;
    }
    .btn {
      background-color: #007bff;
      color: white;
      padding: 12px 25px;
      border-radius: 5px;
      font-weight: bold;
      transition: background-color 0.3s ease, transform 0.2s ease;
      text-transform: uppercase;
      width: fit-content;
    }
    .btn:hover {
      background-color: #0056b3;
      transform: translateY(-2px);
    }
    .live-exam-btn {
      background-color: #28a745 !important;
      border-color: #28a745 !important;
      box-shadow: 0 4px 8px rgba(0, 123, 0, 0.2) !important;
      position: relative;
    }
    .live-exam-btn:hover {
      background-color: #218838 !important;
      transform: translateY(-2px);
    }
    .schedule-exam-btn {
      background-color: #ffc107 !important;
      border-color: #ffc107 !important;
      box-shadow: 0 4px 8px rgba(255, 193, 7, 0.2);
    }
    .schedule-exam-btn:hover {
      background-color: #e0a800;
      transform: translateY(-2px);
    }
    .back-btn-container {
      text-align: center;
      margin-top: 40px;
    }
    .back-btn-container .btn {
      width: fit-content;
      font-size: 1rem;
    }
    .correct-answer {
      background-color: #28a745;
      color: white;
      font-weight: bold;
      padding: 8px 15px;
      border-radius: 5px;
    }
    .exam-report-section {
      padding: 20px;
      border: 1px solid #e9ecef;
      border-radius: 8px;
      margin-bottom: 30px;
      background-color: #f8f9fa;
    }
    @media (max-width: 768px) {
      .header-info {
        flex-direction: column;
        text-align: center;
      }
      .header-info p {
        margin-bottom: 10px;
      }
      .questions-section h4 {
        font-size: 1.2rem;
      }
    }
  </style>
</head>
<body>
  <div class="container my-4">
    <div class="row">
      <div class="col-md-12">
        <div class="exam-details-card shadow">
          <h3><%= exam.examName %></h3>
          <div class="header-info">
            <p class="created-by">
              <strong>Created By:</strong> <%= exam.creatorId.username %>
            </p>
            <p class="duration">
              <strong>Duration:</strong> <%= exam.duration %> minutes
            </p>
          </div>
          <div class="header-info">
            <p class="creation-date">
              <strong>Created On:</strong> <%= new Date(exam.createdAt).toLocaleString() %>
            </p>
            <p>
              <strong>Scheduled Date:</strong> 
              <%= exam.scheduleDate ? new Date(exam.scheduleDate).toLocaleDateString() : "N/A" %>
            </p>
            <p>
              <strong>Scheduled Time:</strong> 
              <%= exam.scheduleTime ? exam.scheduleTime : "N/A" %>
            </p>
          </div>
          <div class="d-flex justify-content-between mt-3">
            <% if (exam.scheduleDate && new Date(exam.scheduleDate) <= new Date()) { %>
              <a href="/examiner/dashboard/<%= exam._id %>/live">
                <button class="btn live-exam-btn">Go Live</button>
              </a>
            <% } else { %>
              <a href="/examiner/dashboard/<%= exam._id %>/schedule">
                <button class="btn schedule-exam-btn">Schedule Exam</button>
              </a>
            <% } %>
          </div>
        </div>

        <div class="exam-report-section">
          <h3 class="text-center">Exam Report</h3>
          <% if (examEntry) { %>
            <p><strong>Total Submissions:</strong> <%= examEntry.totalSubmissions %></p>
            <p><strong>Examinee IDs:</strong></p>
            <ul>
              <% examEntry.examineeIds.forEach(function(id) { %>
                <li><%= id %></li>
              <% }); %>
            </ul>
          <% } else { %>
            <p class="text-center">No statistics available for this exam.</p>
          <% } %>
        </div>

        <div class="questions-section">
          <h4>Questions:</h4>
          <ul>
            <% exam.questions.forEach((question, index) => { %>
              <li>
                <p>
                  <strong>Question <%= index + 1 %>:</strong> <%= question.questionText %>
                </p>
                <ul class="options-list">
                  <% question.options.forEach((option, i) => { %>
                    <li class="<%= i === question.correctAnswer ? 'correct-answer' : '' %>">
                      <%= String.fromCharCode(65 + i) %>. <%= option %>
                    </li>
                  <% }); %>
                </ul>
                <p>
                  <strong>Correct Answer:</strong> <%= String.fromCharCode(65 + question.correctAnswer) %>
                </p>
              </li>
            <% }); %>
          </ul>
        </div>
        <div class="back-btn-container">
          <a href="/examiner/dashboard">
            <button class="btn btn-primary">Back to Dashboard</button>
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS (if needed for interactivity) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
